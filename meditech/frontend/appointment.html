<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Appointments</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <link rel="stylesheet" href="assets/css/style.css">
  <style>
    .gantt-chart {
      display: grid;
      grid-template-columns: 100px 100px repeat(10, 1fr);
      grid-gap: 5px;
      margin: 20px 0;
    }

    .gantt-row {
      display: contents;
    }

    .gantt-cell {
      background-color: #5c85d6;
      border-radius: 5px;
      text-align: center;
      cursor: pointer;
      padding: 10px;
      color: white;
    }

    .gantt-cell:hover {
      background-color: #4a6fb3;
    }

    .gantt-header {
      font-weight: bold;
      text-align: center;
      background-color: #4a6fb3;
      color: white;
      padding: 10px;
    }

    .gantt-date, .gantt-day {
      font-weight: bold;
      text-align: center;
      padding: 10px;
      background-color: #d1e0f2;
    }

    .arrow {
      cursor: pointer;
      font-size: 2rem;
      color: #5c85d6;
      user-select: none;
    }

    .arrow:hover {
      color: #4a6fb3;
    }
  </style>
</head>
<body>
  <nav class="navbar navbar-expand-lg">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">
        <img src="assets/imgs/transparent_meditech_logo.png" alt="Meditech Logo">      </a>
      <div class="collapse navbar-collapse justify-content-end">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link btn-custom" href="/frontend/patient.html">Patient Data</a>
          </li>
          <li class="nav-item">
            <a class="nav-link btn-custom" href="/frontend/appointment.html">Appointment</a>
          </li>
          <li class="nav-item">
            <a class="nav-link btn-custom" href="/frontend/medicalrecords.html">Medical Records</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <div class="container">
    <div class="d-flex justify-content-between align-items-center mt-4">
      <span class="arrow" onclick="changeWeek(-1)">&#9664;</span>
      <h3 class="text-center">Appointments for the Week</h3>
      <span class="arrow" onclick="changeWeek(1)">&#9654;</span>
    </div>
    <div class="gantt-chart">
      <!-- Headers -->
      <div class="gantt-header">Day</div>
      <div class="gantt-header">Date</div>
      <div class="gantt-header">8 AM</div>
      <div class="gantt-header">9 AM</div>
      <div class="gantt-header">10 AM</div>
      <div class="gantt-header">11 AM</div>
      <div class="gantt-header">12 PM</div>
      <div class="gantt-header">1 PM</div>
      <div class="gantt-header">2 PM</div>
      <div class="gantt-header">3 PM</div>
      <div class="gantt-header">4 PM</div>
      <div class="gantt-header">5 PM</div>
      <!-- Mock appointments -->
      <!-- <div class="gantt-day" id="monday-day">Monday</div>
      <div class="gantt-date" id="monday-date">01/01/2024</div>
      <div class="gantt-cell" style="grid-column: span 2;" onclick="showPatientData('John Doe', 'john.doe@example.com', '123456')">John Doe</div>
      <div class="gantt-cell" style="grid-column: span 2;" onclick="showPatientData('Jane Smith', 'jane.smith@example.com', '123457')">Jane Smith</div>
      <div class="gantt-cell" style="grid-column: span 1;" onclick="showPatientData('Alice Johnson', 'alice.johnson@example.com', '123458')">Alice Johnson</div>
      <div class="gantt-cell" style="grid-column: span 3;" onclick="showPatientData('Bob Brown', 'bob.brown@example.com', '123459')">Bob Brown</div>
      <div class="gantt-cell" style="grid-column: span 1;" onclick="showPatientData('Charlie Davis', 'charlie.davis@example.com', '123460')">Charlie Davis</div>
      <div class="gantt-cell" style="grid-column: span 2;" onclick="showPatientData('Diana Evans', 'diana.evans@example.com', '123461')">Diana Evans</div>
      <div class="gantt-day" id="tuesday-day">Tuesday</div>
      <div class="gantt-date" id="tuesday-date">02/01/2024</div>
      <div class="gantt-cell" style="grid-column: span 2;" onclick="showPatientData('John Doe', 'john.doe@example.com', '123456')">John Doe</div>
      <div class="gantt-cell" style="grid-column: span 2;" onclick="showPatientData('Jane Smith', 'jane.smith@example.com', '123457')">Jane Smith</div>
      <div class="gantt-cell" style="grid-column: span 1;" onclick="showPatientData('Alice Johnson', 'alice.johnson@example.com', '123458')">Alice Johnson</div>
      <div class="gantt-cell" style="grid-column: span 3;" onclick="showPatientData('Bob Brown', 'bob.brown@example.com', '123459')">Bob Brown</div>
      <div class="gantt-cell" style="grid-column: span 1;" onclick="showPatientData('Charlie Davis', 'charlie.davis@example.com', '123460')">Charlie Davis</div>
      <div class="gantt-cell" style="grid-column: span 2;" onclick="showPatientData('Diana Evans', 'diana.evans@example.com', '123461')">Diana Evans</div>
      <div class="gantt-day" id="wednesday-day">Wednesday</div>
      <div class="gantt-date" id="wednesday-date">03/01/2024</div>
      <div class="gantt-cell" style="grid-column: span 2;" onclick="showPatientData('John Doe', 'john.doe@example.com', '123456')">John Doe</div>
      <div class="gantt-cell" style="grid-column: span 2;" onclick="showPatientData('Jane Smith', 'jane.smith@example.com', '123457')">Jane Smith</div>
      <div class="gantt-cell" style="grid-column: span 1;" onclick="showPatientData('Alice Johnson', 'alice.johnson@example.com', '123458')">Alice Johnson</div>
      <div class="gantt-cell" style="grid-column: span 3;" onclick="showPatientData('Bob Brown', 'bob.brown@example.com', '123459')">Bob Brown</div>
      <div class="gantt-cell" style="grid-column: span 1;" onclick="showPatientData('Charlie Davis', 'charlie.davis@example.com', '123460')">Charlie Davis</div>
      <div class="gantt-cell" style="grid-column: span 2;" onclick="showPatientData('Diana Evans', 'diana.evans@example.com', '123461')">Diana Evans</div>
      <div class="gantt-day" id="thursday-day">Thursday</div>
      <div class="gantt-date" id="thursday-date">04/01/2024</div>
      <div class="gantt-cell" style="grid-column: span 2;" onclick="showPatientData('John Doe', 'john.doe@example.com', '123456')">John Doe</div>
      <div class="gantt-cell" style="grid-column: span 2;" onclick="showPatientData('Jane Smith', 'jane.smith@example.com', '123457')">Jane Smith</div>
      <div class="gantt-cell" style="grid-column: span 1;" onclick="showPatientData('Alice Johnson', 'alice.johnson@example.com', '123458')">Alice Johnson</div>
      <div class="gantt-cell" style="grid-column: span 3;" onclick="showPatientData('Bob Brown', 'bob.brown@example.com', '123459')">Bob Brown</div>
      <div class="gantt-cell" style="grid-column: span 1;" onclick="showPatientData('Charlie Davis', 'charlie.davis@example.com', '123460')">Charlie Davis</div>
      <div class="gantt-cell" style="grid-column: span 2;" onclick="showPatientData('Diana Evans', 'diana.evans@example.com', '123461')">Diana Evans</div>
      <div class="gantt-day" id="friday-day">Friday</div>
      <div class="gantt-date" id="friday-date">05/01/2024</div>
      <div class="gantt-cell" style="grid-column: span 2;" onclick="showPatientData('John Doe', 'john.doe@example.com', '123456')">John Doe</div>
      <div class="gantt-cell" style="grid-column: span 2;" onclick="showPatientData('Jane Smith', 'jane.smith@example.com', '123457')">Jane Smith</div>
      <div class="gantt-cell" style="grid-column: span 1;" onclick="showPatientData('Alice Johnson', 'alice.johnson@example.com', '123458')">Alice Johnson</div>
      <div class="gantt-cell" style="grid-column: span 3;" onclick="showPatientData('Bob Brown', 'bob.brown@example.com', '123459')">Bob Brown</div>
      <div class="gantt-cell" style="grid-column: span 1;" onclick="showPatientData('Charlie Davis', 'charlie.davis@example.com', '123460')">Charlie Davis</div>
      <div class="gantt-cell" style="grid-column: span 2;" onclick="showPatientData('Diana Evans', 'diana.evans@example.com', '123461')">Diana Evans</div>
      <div class="gantt-day" id="saturday-day">Saturday</div>
      <div class="gantt-date" id="saturday-date">06/01/2024</div>
      <div class="gantt-cell" style="grid-column: span 2;" onclick="showPatientData('John Doe', 'john.doe@example.com', '123456')">John Doe</div>
      <div class="gantt-cell" style="grid-column: span 2;" onclick="showPatientData('Jane Smith', 'jane.smith@example.com', '123457')">Jane Smith</div>
      <div class="gantt-cell" style="grid-column: span 1;" onclick="showPatientData('Alice Johnson', 'alice.johnson@example.com', '123458')">Alice Johnson</div>
      <div class="gantt-cell" style="grid-column: span 3;" onclick="showPatientData('Bob Brown', 'bob.brown@example.com', '123459')">Bob Brown</div>
      <div class="gantt-cell" style="grid-column: span 1;" onclick="showPatientData('Charlie Davis', 'charlie.davis@example.com', '123460')">Charlie Davis</div>
      <div class="gantt-cell" style="grid-column: span 2;" onclick="showPatientData('Diana Evans', 'diana.evans@example.com', '123461')">Diana Evans</div>
      <div class="gantt-day" id="sunday-day">Sunday</div>
      <div class="gantt-date" id="sunday-date">07/01/2024</div>
      <div class="gantt-cell" style="grid-column: span 2;" onclick="showPatientData('John Doe', 'john.doe@example.com', '123456')">John Doe</div>
      <div class="gantt-cell" style="grid-column: span 2;" onclick="showPatientData('Jane Smith', 'jane.smith@example.com', '123457')">Jane Smith</div>
      <div class="gantt-cell" style="grid-column: span 1;" onclick="showPatientData('Alice Johnson', 'alice.johnson@example.com', '123458')">Alice Johnson</div>
      <div class="gantt-cell" style="grid-column: span 3;" onclick="showPatientData('Bob Brown', 'bob.brown@example.com', '123459')">Bob Brown</div>
      <div class="gantt-cell" style="grid-column: span 1;" onclick="showPatientData('Charlie Davis', 'charlie.davis@example.com', '123460')">Charlie Davis</div>
      <div class="gantt-cell" style="grid-column: span 2;" onclick="showPatientData('Diana Evans', 'diana.evans@example.com', '123461')">Diana Evans</div> -->
    </div>
  </div>

  <!-- Patient Data Modal -->
  <div class="modal fade" id="patientDataModal" tabindex="-1" aria-labelledby="patientDataModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="patientDataModalLabel">Patient Data</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form>
            <div class="row mb-3">
              <label for="patientID" class="col-sm-2 col-form-label">Patient ID</label>
              <div class="col-sm-10">
                <input type="text" class="form-control" id="patientID" readonly>
              </div>
            </div>
            <div class="row mb-3">
              <label for="patientName" class="col-sm-2 col-form-label">Name</label>
              <div class="col-sm-10">
                <input type="text" class="form-control" id="patientName" readonly>
              </div>
            </div>
            <div class="row mb-3">
              <label for="patientEmail" class="col-sm-2 col-form-label">Email</label>
              <div class="col-sm-10">
                <input type="email" class="form-control" id="patientEmail" readonly>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
  <script>
    function showPatientData(name, email, id) {
      document.getElementById('patientName').value = name;
      document.getElementById('patientEmail').value = email;
      document.getElementById('patientID').value = id;
      new bootstrap.Modal(document.getElementById('patientDataModal')).show();
    }

    function changeWeek(direction) {
      // Function to change the week, fetching new data as needed
      console.log("Change week by: ", direction);
    }

  fetch('http://localhost:5000/users/users/bookings', {
    method: 'GET',
    headers: new Headers({
            'Authorization': 'Bearer ' + localStorage.getItem("token"),
    })
  })
  .then(response => response.json())
  .then(data => {
    const appointmentHTML = [];
    data.forEach(appointment => {
      const date = new Date(appointment.date);
      const day = date.toLocaleString('en-US', { weekday: 'long' });
      const dateStr = date.toLocaleDateString('en-US');
      const patientName = appointment.name;
      const patientEmail = appointment.email;
      const patientId = appointment.id;

      appointmentHTML.push(`
        <div class="gantt-day" id="${day}-day">${day}</div>
        <div class="gantt-date" id="${dateStr}-date">${dateStr}</div>
        <div class="gantt-cell" style="grid-column: span ${appointment.duration};" onclick="showPatientData('${patientName}', '${patientEmail}', '${patientId}')">${patientName}</div>
      `);
    });

    document.getElementById('appointment-container').innerHTML = appointmentHTML.join('');
  });  </script>
</body>
</html>
